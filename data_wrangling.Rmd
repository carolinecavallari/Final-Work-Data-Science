---
title: "Plots"
author: "Caroline & Julia"
date: "12/7/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r}
# Creating a month_year column for the closures_df dataframe

sf <- stamp("02-2019", orders = "my") 

closures_df$Date <- lubridate::dmy(closures_df$Date)

closures_df <- closures_df %>%
  mutate(month_year = sf(Date))


#school closure

is.factor(closures_df$Status)
table(closures_df$Status)
closures_df$Status <- factor(closures_df$Status, levels = c("Closed due to COVID-19 ", "Partially open", "Fully open", "Academic break"))



#creating a table for closures_df

closures_table_df <- select(complete_schools_df, c(country, region, 
                          fully_closed, partially_closed, internet_access,
                          vac_priority_status, total_students, tv, radio, online_learning))

```





```{r}
##Wrangling Teacher vaccination data
names(teacher_vac_df)[names(teacher_vac_df) == "Vaccination data reference date"] <- "Date"
names(teacher_vac_df)[names(teacher_vac_df) == "Teacher prioritization in vaccination plans"] <- "vac_priority_status"
head(teacher_vac_df)

is.factor(teacher_vac_df$vac_priority_status)
table(teacher_vac_df$vac_priority_status)
teacher_vac_df$vac_priority_status<- factor(teacher_vac_df$vac_priority_status, levels = c("Group 1", "Group 2", "Group 3 or lower", "Not prioritized", "Not specified", "No data"))
```


```{r}
#Wrangling cumulative_closure_df
head(cumulative_closure_df)

names(cumulative_closure_df)[names( cumulative_closure_df) == "UNICEF Country"] <- "country"
names(cumulative_closure_df)[names( cumulative_closure_df) == "UNICEF Region"] <- "region"
names(cumulative_closure_df)[names( cumulative_closure_df) == "Income Group"] <- "income_group"
names(cumulative_closure_df)[names( cumulative_closure_df) == "Days: Academic break"] <- "academic_break"
names(cumulative_closure_df)[names( cumulative_closure_df) == "Days: Fully closed"] <- "fully_closed"
names(cumulative_closure_df)[names( cumulative_closure_df) == "Days: Fully open"] <- "fully_open"
names(cumulative_closure_df)[names( cumulative_closure_df) == "Days:  Partially closed"] <- "partially_closed"
names(cumulative_closure_df)[names( cumulative_closure_df) == "Instruction Days"] <- "instructions_date"
names(cumulative_closure_df)[names( cumulative_closure_df) == "Pre-primary"] <- "pre_primary"
names(cumulative_closure_df)[names( cumulative_closure_df) == "Lower Secondary"] <- "lower_secondary"
names(cumulative_closure_df)[names( cumulative_closure_df) == "Upper Secondary"] <- "upper_secondary"
```


```{r}
##Wrangling connectivity data
head(Total_school_connectivity_df)

names(Total_school_connectivity_df)[names(Total_school_connectivity_df) == "Countries and areas"] <- "country"
names(Total_school_connectivity_df)[names(Total_school_connectivity_df) == "Sub-region"] <- "sub_region"
names(Total_school_connectivity_df)[names(Total_school_connectivity_df) == "Income Group"] <- "income_group"
names(Total_school_connectivity_df)[names(Total_school_connectivity_df) == "...12"] <- "Date"
```


```{r}
#Wrangling Vaccination rates
head(teacher_vac_df)
names(teacher_vac_df)[names(teacher_vac_df) == "Country"] <- "country"
names(teacher_vac_df)[names(teacher_vac_df) == "% of teachers with at least one dosis"] <- "first_shot"
names(teacher_vac_df)[names(teacher_vac_df) == "% of teachers fully vaccinated"] <- "second_shot"
```


```{r}
#Join data frames and create complete_schools_df
complete_schools_df <- dplyr::left_join(cumulative_closure_df,
Total_school_connectivity_df, 
  by = "ISO3" ## Be specific about the joining column
  ) %>%
select(ISO3, country.x, region, income_group.x, academic_break, fully_closed, fully_open, partially_closed, instructions_date, pre_primary, Primary, lower_secondary, upper_secondary, Total)

names(complete_schools_df)[names(complete_schools_df) == "income_group.x"] <- "income_group"
names(complete_schools_df)[names(complete_schools_df) == "country.x"] <- "country"
names(complete_schools_df)[names(complete_schools_df) == "Total"] <- "internet_access"
names(complete_schools_df)[names(complete_schools_df) == "Primary"] <- "primary"


complete_schools_df <- dplyr::left_join(complete_schools_df,
teacher_vac_df, 
  by = "country" 
  ) %>%
  select(-c(first_shot, second_shot, Date))

head(complete_schools_df)

complete_schools_df <- complete_schools_df %>%
  mutate(., total_students = pre_primary + primary + lower_secondary + upper_secondary, .keep = "all")
complete_schools_df

complete_schools_df 
is.factor(complete_schools_df$vac_priority_status)
table(complete_schools_df$vac_priority_status)


table(complete_schools_df$region)


```



```{r}
#Wrangling UNESCO Database for distance learning 

names(UNESCO_school_closures_df)[names(UNESCO_school_closures_df) == "Country ID"] <- "country_id"
names(UNESCO_school_closures_df)[names(UNESCO_school_closures_df) == "Country"] <- "country"
names(UNESCO_school_closures_df)[names(UNESCO_school_closures_df) == "Region 1"] <- "region"
names(UNESCO_school_closures_df)[names(UNESCO_school_closures_df) == "Status"] <- "status"
names(UNESCO_school_closures_df)[names(UNESCO_school_closures_df) == "Enrolment (Pre-Primary to Tertiary)"] <- "enrollment"
names(UNESCO_school_closures_df)[names(UNESCO_school_closures_df) == "Teachers (Pre-Primary to Upper Secondary)"] <- "teachers_number"
names(UNESCO_school_closures_df)[names(UNESCO_school_closures_df) == "Distance learning modalities (TV)"] <- "tv"
names(UNESCO_school_closures_df)[names(UNESCO_school_closures_df) == "Distance learning modalities (Radio)"] <- "radio"
names(UNESCO_school_closures_df)[names(UNESCO_school_closures_df) == "Distance learning modalities (Online)"] <- "online_learning"
names(UNESCO_school_closures_df)[names(UNESCO_school_closures_df) == "Distance learning modalities (Global)"] <- "distance_learning"
names(UNESCO_school_closures_df)[names(UNESCO_school_closures_df) == "Weeks partially open"] <- "weeks_partially_closed"  
names(UNESCO_school_closures_df)[names(UNESCO_school_closures_df) == "Weeks fully closed"] <- "weeks_fully_closed"                                   
head(UNESCO_school_closures_df)                                 

UNESCO_school_closures_df <- UNESCO_school_closures_df %>%
  select(., Date, country_id, country, region, status, enrollment, teachers_number, tv, radio, online_learning, distance_learning, weeks_partially_closed, weeks_fully_closed)


UNESCO_school_closures_df$Date <- lubridate::ymd(UNESCO_school_closures_df$Date)

typeof(UNESCO_school_closures_df$Date)


```

