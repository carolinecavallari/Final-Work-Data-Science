install.packages("shinydashboard")

##Defining shiny dashboard components and publishing
```{r}
library(shinydashboard)
library(shiny)

ui <- fluidPage(
  titlePanel("Basic dashboard"),
  sidebarLayout(
<<<<<<< HEAD
    sidebarPanel("sidebar panel"),
    mainPanel("main panel")
=======
    sidebarPanel(
      helpText("sidebar panel"),
      
      selectInput("month_select", label = "Select the Month",
          choices = c("02-2020","03-2020","04-2020",
                      "05-2020","06-2020","07-2020",
                      "08-2020","09-2020","10-2020",
                      "11-2020","12-2020","01-2021",
                      "02-2021","03-2021","04-2021",
                      "05-2021","06-2021","07-2021",
                      "08-2021","09-2021","10-2021",
                      "11-2021"),
          selected = "02-2020"),
    ),
    mainPanel(
      plotlyOutput("fig", width = "100%")
      )
>>>>>>> parent of 6d2ea44... another update to shiny script
  ))


server <- function(input, output) {
  # set.seed(122)
  # histdata <- rnorm(500)
  # 
  # output$plot1 <- renderPlot({
  #   data <- histdata[seq_len(input$slider)]
  #   hist(data)
  # })
}

shinyApp(ui, server)

```

## Dataframes
```{r}
library(tidyverse)
library(readr)
library(lubridate)
closures_df <- read_csv("covid_impact_education.csv")

view(closures_df)

# Creating a month_year column
sf <- stamp("02-2019", orders = "my") 

closures_df$Date <- lubridate::dmy(closures_df$Date)

closures_df <- closures_df %>%
  mutate(month_year = sf(Date))


is.factor(closures_df$Status)
table(closures_df$Status)
closures_df$Status <- factor(closures_df$Status, levels = c("Closed due to COVID-19 ", "Partially open", "Fully open", "Academic break"))






```

## Plots
```{r}
library(ggplot2)
library(ggpubr)
library(plotly)

# light grey boundaries
l <- list(color = toRGB("grey"), width = 0.5)

# specify map projection/options
g <- list(
  showframe = FALSE,
  showcoastlines = FALSE,
  projection = list(type = 'Mercator')
)

closures_test <- closures_df %>%
  dplyr::filter(month_year == "01-2021")

fig <- plot_geo(closures_df)

fig <- plot_ly(closures_test, type='choropleth', locations=closures_test$ISO, z=closures_test$Status, text=closures_test$Country)

fig
fig <- fig %>% add_trace(
    z = ~Status, color = ~Status, 
    text = ~Country, locations = ~ISO, marker = list(line = l)
  )

fig <- fig %>% colorbar(title = 'GDP Billions US$', tickprefix = '$')
fig <- fig %>% layout(
    title = '2014 Global GDP<br>Source:<a href="https://www.cia.gov/library/publications/the-world-factbook/fields/2195.html">CIA World Factbook</a>',
    geo = g
  )



```
